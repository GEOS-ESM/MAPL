#include "MAPL_TestErr.h"
#include "unused_dummy.H"

module Test_GenericGridComp
   use mapl3g_UserSetServices
   use mapl3g_GenericGridComp
   use ESMF
   use pfunit
   implicit none

contains

   @test(npes=[0])
   subroutine test_is_generic(this)
      class(MpiTestMethod), intent(inout) :: this

      type(ESMF_GridComp) :: outer_gc
      integer :: status
      type(ESMF_Info) :: info
      type(ESMF_HConfig) :: hconfig
      logical :: is_generic

      hconfig = ESMF_HConfigCreate(content='{}')

      outer_gc = MAPL_GridCompCreate('ROOT', user_setservices('libsimple_parent_gridcomp'), hconfig, _RC)

      call ESMF_InfoGetFromHost(outer_gc, info, _RC)
      call ESMF_InfoGet(info, key='MAPL/GRIDCOMP_IS_GENERIC', value=is_generic, _RC)
      @assert_that(is_generic,is(true()))

      call ESMF_HConfigDestroy(hconfig, _RC)

      _UNUSED_DUMMY(this)
   end subroutine test_is_generic
end module Test_GenericGridComp

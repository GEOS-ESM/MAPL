#include "MAPL_Generic.h"
#define CONSTRUCT_ f = FieldCondensedArrayDims
#define TEST_ARGS_(E, M) @assertEqual(E, f%arguments(), 'f%arguments() does not match ' // M // '.')
#define EXPECT_(A) [X, Y, Z, A]
#define EXPECT3_ EXPECT_([integer::])
#define EXPECT2A_(A) [X, Y, A]
#define EXPECT2_ [X, Y]
module Test_FieldCondensedArray

   use mapl3g_FieldCondensedArrayDims
   use pfunit

   implicit none

   integer, parameter :: X = 1
   integer, parameter :: Y = X+1
   integer, parameter :: Z = Y+1
   integer, parameter :: W(2) = [Z+1, Z+2]
   integer, parameter :: W1(1) = [W(1)]
   type(FieldCondensedArrayDims) :: f

contains

   @Test
   subroutine test_construct()

      CONSTRUCT_(X, Y, Z, W)
      TEST_ARGS_(EXPECT_(W), 'expected(5)')

      CONSTRUCT_(X, Y, Z, W1)
      TEST_ARGS_(EXPECT(W1), 'expected(4)')
      
   end subroutine test_construct

   @Test
   subroutine test_construct_noungridded()

      CONSTRUCT_(X, Y, Z)
      TEST_ARGS_(EXPECT3_, 'expected(3)')

   end subroutine test_construct_noungridded

   @Test
   subroutine test_construct_noz()

      CONSTRUCT_(X, Y, W)
      TEST_ARGS_(EXPECT2A_, 'expected')

   end subroutine test_construct_noz

   @Test
   subroutine test_construct_noz_noungridded()

      CONSTRUCT_(X, Y, W)
      TEST_ARGS_(EXPECT2_, 'expected')

   end subroutine test_construct_noz_noungridded

   @Test
   subroutine test_construct_1hx()
   end subroutine test_construct_1hx

   @Test
   subroutine test_construct_1hy()
   end subroutine test_construct_1hy

   @Test
   subroutine test_construct_1hx_noungridded()
   end subroutine test_construct_1hx_noungridded
   
   @Test
   subroutine test_construct_1hy_noungridded()
   end subroutine test_construct_1hy_noungridded
   
   @Test
   subroutine test_construct_dimcount0()
   end subroutine test_construct_dimcount0

   @Test
   subroutine test_construct_vert()
   end subroutine test_construct_vert
   
   @Test
   subroutine test_construct_vert_noungridded()
   end subroutine test_construct_vert_noungridded

   @Test
   subroutine test_horizontal()
   end subroutine test_horizontal
   
   @Test
   subroutine test_vertical()
   end subroutine test_vertical
   
   @Test
   subroutine test_ungridded()
   end subroutine test_ungridded
   
   @Test
   subroutine test_dims()
   end subroutine test_dims
   
   @Before
   subroutine setup()
   end subroutine set_up_data

   @after
   subroutine teardown()
   end subroutine teardown

end module Test_FieldCondensedArray
